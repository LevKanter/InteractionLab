<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Fun With Canvas</title>
		<link rel="stylesheet" href="sketch.css">
	</head>
	<body>
	
		<canvas>
			<p>canvas not supported</p>
		</canvas>
	
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
		<script src="Sketch.js"></script>
		<script src="PVector.js"></script>
		<script src="Particle.js"></script>
		<script>
			(function(window, $) {
			
				var particles,
				    anchors,
				    gw,
				    gh,
				    gspacing;
			
				$(document).ready(function() {
			
					Sketch({
						selector: "canvas",
					
						setup: function(S) {
							var i, j, p;
						
							gw = 40;
							gh = 30;
							gspacing = 26;
						
							particles = [];
							anchors = [];
						
							for (i = 0; i < gw; i += 1) {
								for (j = 0; j < gh; j += 1) {
									p = Particle();
									p.drag.set(0.8, 0.8);
									p.pos.set(i*gspacing, j*gspacing);
								
									particles.push(p);
									anchors.push(new PVector(p.pos.x, p.pos.y));
								}
							}
						},
						update: function(S) {
							var i;
							
							for (i = 0; i < particles.length; i += 1) {
								particles[i].update();
								particles[i].attract(new PVector(S.mouseX, S.mouseY), 300, 8.5);
								particles[i].applyForce(PVector.div(PVector.sub(anchors[i], particles[i].pos), 25));
							}
						},
						draw: function(S) {
							var i;
							S.ctx.clearRect(0, 0, S.width, S.height);
							
							for (i = 0; i < particles.length; i += 1) {
								S.ctx.fillStyle = "#00aacc";
								S.ctx.beginPath();
								S.ctx.save();
								S.ctx.translate(particles[i].pos.x, particles[i].pos.y);
								S.ctx.arc(0, 0, 10, 0, 2*Math.PI, true);
								S.ctx.restore();
								S.ctx.closePath();
								S.ctx.fill();
							}
						},
						mousePressed: function() {
						
						},
						mouseReleased: function() {
					
						},
						keyPressed: function () {
						
						}
					});
				});
			
			}(this, this.jQuery));
		</script>
	</body>
</html>